<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6928875782056223" crossorigin="anonymous"></script>
    <link rel="icon" sizes="192x192" href="Lille_FM_icon.ico" type="image/png" />
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Radio</title>
</head>
<body>
    <center><h1>Écouter Lille FM</h1></center>

    <br>

    <lecteur>
        <center>
        <audio id="audioPlayer" controls autoplay>
            <source src="https://uk9freenew.listen2myradio.com/live.mp3?typeportmount=s1_10341_stream_1862423" type="audio/mpeg">
            Votre navigateur ne supporte pas l'élément audio.
        </audio>

    <div id="offlineMessage">
        <p>Lille FM est hors antenne, mais nous revenons bientôt !</p>
    </div>
</center>
 </lecteur>

    
        <elem_un><p>Le lecteur est en bêta et n'est pas forcément 100% fonctionnel, mais vous pourrez toujours accéder à Lille FM via <a href="https://lillefm.radio12345.com/">ce lien</a>.</p></elem_un>


    <script>
        var audioPlayer = document.getElementById('audioPlayer');
        var offlineMessage = document.getElementById('offlineMessage');
        var textMessage = document.getElementById('textMessage');

        function hideTextMessage() {
            offlineMessage.style.display = 'none';
            textMessage.style.display = 'none';
        }

        function showOfflineMessage() {
            offlineMessage.style.display = 'block';
            textMessage.style.display = 'none';
        }

        function showTextMessage() {
            offlineMessage.style.display = 'none';
            textMessage.style.display = 'block';
        }

        audioPlayer.addEventListener('playing', hideTextMessage);
        audioPlayer.addEventListener('pause', showTextMessage);
        audioPlayer.addEventListener('ended', showOfflineMessage);
    </script>
    <script>
// URL de l'API
const url = 'http://192.168.1.27:9000/?pass=59922&action=playbackinfo';
    async function getSongTitle() {
    try {
        // Envoi de la requête GET à l'API
        const response = await fetch(url);
        
        // Vérification de la réponse
        if (!response.ok) {
            throw new Error('La requête a échoué');
        }
        
        // Conversion de la réponse en texte
        const xmlText = await response.text();
        
        // Analyse de la réponse XML
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
        
        // Extraction du titre de la chanson
        const title = xmlDoc.querySelector('TRACK').getAttribute('TITLE');
        
        // Affichage du titre dans un élément HTML
        const songTitleElement = document.getElementById('songTitle');
        songTitleElement.textContent = 'Titre de la chanson actuellement jouée : ' + title;
        
        // Retour du titre
        return title;
    } catch (error) {
        console.error('Une erreur s\'est produite :', error);
    }
}

// Appel de la fonction pour extraire le titre de la chanson
getSongTitle();
</script>
       <style>
        lecteur {
            bottom: 45%;
            position: absolute;
            left: 50%;
        	width: 18rem;
        	margin-left: -9rem;
        }

        elem_un{
            bottom: 3px;
            left: 3px;
            position: absolute;
        }

        elem_de{
        }
    </style>
</body>
</html>
